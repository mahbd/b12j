(this.webpackJsonpb12j_front=this.webpackJsonpb12j_front||[]).push([[0],{108:function(t,e,a){"use strict";a.r(e);var n=a(0),s=a(32),o=a.n(s),c=a(3),r=(a(61),a(1)),i=a.n(r),l=a(27),d=a(10),u=a(18),b=a(9),f=a(12),p=a(11),h=a(5),g=a(22),j=a(20),m=a(8),v=a.n(m),O=a(16),y=a(19),x=a.n(y),S=a(50);x.a.defaults.headers.common["x-auth-token"]=A(),x.a.interceptors.response.use(null,(function(t){return t.response&&t.response.status>=400&&t.response.status<500||(console.log("Logging the error",t),alert("An unexpected error.")),Promise.reject(t)}));var N={get:x.a.get,post:x.a.post,put:x.a.put,delete:x.a.delete},_="localhost"===document.domain?"http://127.0.0.1:8000/api":document.location.protocol+"//"+document.location.host+"/api",w={contests:"/contests",submissions:"/submissions",standing:"/contests/standing",problems:"/problems",tutorials:"/tutorials",chat:"/chat",cf:"/cf",cfProblems:"cf/problems",cfStatics:"cf/statics",users:"/users",login:"/users/login",register:"/users/register",logout:"/users/logout"};function k(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";localStorage.removeItem("token"),window.location=t}function I(){try{var t=localStorage.getItem("token");return Object(S.a)(t)}catch(e){return null}}function A(){return localStorage.getItem("token")}var C=Object(d.b)("api/callBegan"),q=Object(d.b)("api/callFailed");x.a.defaults.headers.common["x-auth-token"]=A();var R=function(t){var e=t.dispatch;return function(t){return function(){var a=Object(O.a)(v.a.mark((function a(n){var s,o,c,r,i,l,d,u,b;return v.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.type===C.type){a.next=2;break}return a.abrupt("return",t(n));case 2:return s=n.payload,o=s.url,c=s.method,r=s.data,i=s.onSuccess,l=s.onError,d=s.onStart,u=s.onFailed,d&&e({type:d}),t(n),a.prev=5,a.next=8,x.a.request({baseURL:_,url:o,method:c,data:r});case 8:b=a.sent,i&&e({type:i,payload:b.data}),a.next=17;break;case 12:a.prev=12,a.t0=a.catch(5),u&&e({type:u}),e(q({payload:a.t0.message})),l&&e({type:l,payload:a.t0.message});case 17:case"end":return a.stop()}}),a,null,[[5,12]])})));return function(t){return a.apply(this,arguments)}}()}},B=(a(26),a(52)),P=function(t){var e;return e={},Object(j.a)(e,"".concat(t,"Added"),(function(t,e){t.list.push(e.payload.id),t.dict[e.payload.id]=e.payload,t.loading=!1})),Object(j.a)(e,"".concat(t,"Updated"),(function(t,e){t.dict[e.payload.id]?t.dict[e.payload.id]=e.payload:(t.dict[e.payload.id]=e.payload,t.list.push(e.payload)),t.loading=!1})),Object(j.a)(e,"".concat(t,"sReceived"),(function(t,e){var a=e.payload.results;if(a)for(var n=0;n<a.length;n++)t.dict[a[n].id]=a[n],t.list.push(a[n].id);t.loading=!1})),Object(j.a)(e,"".concat(t,"Requested"),(function(t){t.loading=!0})),Object(j.a)(e,"".concat(t,"RequestFailed"),(function(t){t.loading=!1})),e},U=function(t,e){var a;t.loading=!1;var n=e.payload.next;a=n?function(t){var e=Object(B.parse)(t).offset;return Math.ceil(e/20)}(n):Math.ceil(e.payload.count/20),t.fetched.push(parseInt(a)),t.list[a]=[],t.dict[a]={},t.total=Math.ceil(e.payload.count/20);for(var s=e.payload.results,o=0;o<s.length;o++)t.dict[s[o].id]=s[o],t.list[a].push(s[o].id)},F=function(){function t(e,a,n,s){var o=this;Object(b.a)(this,t),this.requestedIdQueue=[],this.start=function(){o.store.dispatch({type:o.requested.type})},this.failure=function(){o.store.dispatch({type:o.requestFailed.type})},this._load=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w["".concat(o.name,"s")]+"/";o.store.dispatch(C({url:t,onStart:o.requested.type,onSuccess:o.received.type,onFailed:o.requestFailed.type}))},this._loadById=function(t){if(-1===o.requestedIdQueue.indexOf(t)){o.requestedIdQueue.push(t);var e={method:"GET",target:o.name,id:t};o.ws.send(JSON.stringify(e)),o.start()}},this.add=function(t){var e={method:"POST",target:o.name,data:t};o.ws.send(JSON.stringify(e)),o.start()},this.edit=function(t){var e={method:"PUT",target:o.name,id:t.id,data:t};o.ws.send(JSON.stringify(e)),o.start()},this.update=function(t){o.store.dispatch({type:o.updated.type,payload:t})},this.getById=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=o.store.getState()["".concat(o.name,"s")].dict;if(e){if(a[t])return a[t][e];t&&o._loadById(t)}else if(a[t])return a[t];return t&&o._loadById(t),null};var c=e.actions;this.ws=n,this.store=a,this.name=s,this.added=c["".concat(s,"Added")],this.requestFailed=c["".concat(s,"RequestFailed")],this.requested=c["".concat(s,"Requested")],this.received=c["".concat(s,"sReceived")],this.updated=c["".concat(s,"Updated")]}return Object(g.a)(t,[{key:"list",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(t){for(var e=this.store.getState()["".concat(this.name,"s")].dict,a=[],n=0;n<t.length;n++)a.push(e[t[n]]);return a}}}]),t}(),L="contest",T=Object(d.c)({name:"".concat(L,"s"),initialState:Object(h.a)({},{list:[],dict:{},fetched:[],total:null,loading:!1}),reducers:Object(h.a)(Object(h.a)({},P(L)),{},{contestsReceived:function(t,e){U(t,e)}})}),E=T.reducer,J=function(t){Object(f.a)(a,t);var e=Object(p.a)(a);function a(t,n){var s;return Object(b.a)(this,a),(s=e.call(this,T,t,n,L))._loadContest=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=s.store.getState().contests;-1!==e.fetched.indexOf(t)||e.loading||((t<1||e.total&&t>e.total)&&alert("Wrong page"),s._load("/contests/?limit=20&offset=".concat(20*(t-1))))},s.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return s._loadContest(t),s.list(s.store.getState().contests.list[t])},s}return a}(F),M="problem",D=Object(d.c)({name:"".concat(M,"s"),initialState:Object(h.a)({},{list:[],dict:{},fetched:[],total:null,loading:!1}),reducers:Object(h.a)(Object(h.a)({},P(M)),{},{problemsReceived:function(t,e){var a=e.payload.results;if(a.length<1)console.log("No Problems for this contest");else{var n=a[0].contest;t.loading=!1,t.fetched.push(n);for(var s=0;s<a.length;s++)t.dict[a[s].id]=a[s]}}})}),Q=D.reducer,W=function(t){Object(f.a)(a,t);var e=Object(p.a)(a);function a(t,n){var s;return Object(b.a)(this,a),(s=e.call(this,D,t,n,M))._loadProblems=function(t){var e=s.store.getState().problems;-1!==e.fetched.indexOf(t)||e.loading||s._load("/problems/?contest_id=".concat(t))},s.getList=function(t){s._loadProblems(t);var e=[],a=s.store.getState().problems.dict;for(var n in a)a[n].contest===t&&e.push(a[n]);return e},s}return a}(F),G="user",H=Object(d.c)({name:"".concat(G,"s"),initialState:Object(h.a)(Object(h.a)({},{list:[],dict:{},fetched:[],total:null,loading:!1}),{},{info:I()}),reducers:Object(h.a)(Object(h.a)({},P(G)),{},{loggedIn:function(t,e){t.info=e.payload},loggedOut:function(t){t.info=null}})}),z=H.actions.loggedIn,K=H.reducer,V=function(t){Object(f.a)(a,t);var e=Object(p.a)(a);function a(t,n){var s;return Object(b.a)(this,a),(s=e.call(this,H,t,n,G)).loadUsers=function(){s._load("/users/?limit=1000")},s.getList=function(){return s.list(s.store.getState().users.list)},s.firstName=function(t){return s.getById(t,"first_name")},s.fullName=function(t){return s.getById(t,"first_name")+" "+s.getById(t,"last_name")},s.currentUser=function(){return s.store.getState()["".concat(s.name,"s")].info},s.addUserToStore=function(){s.store.dispatch({type:z.type,payload:I()})},s}return a}(F),X="submission",Y=Object(d.c)({name:"".concat(X,"s"),initialState:Object(h.a)({},{list:[],dict:{},fetched:[],total:null,loading:!1}),reducers:Object(h.a)(Object(h.a)({},P(X)),{},{submissionsReceived:function(t,e){U(t,e)},submissionUpdated:function(t,e){!function(t,e){t.dict[e.payload.id]?t.dict[e.payload.id]=e.payload:(t.dict[e.payload.id]=e.payload,t.list[1]||(t.list[1]=[]),t.list[1]=[e.payload.id].concat(Object(l.a)(t.list[1]))),t.loading=!1}(t,e)}})}),Z=Y.reducer,$=function(t){Object(f.a)(a,t);var e=Object(p.a)(a);function a(t,n){var s;return Object(b.a)(this,a),(s=e.call(this,Y,t,n,X))._loadSubmission=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=s.store.getState().submissions;-1!==e.fetched.indexOf(t)||e.loading||(t<1||e.total&&t>e.total?alert("Wrong page"):s._load("/submissions/?limit=20&offset=".concat(20*(t-1))))},s.getList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return s._loadSubmission(t),s.list(s.store.getState().submissions.list[t])},s.submissionDetails=function(t){var e=s.getById(t);if(e){if(e.details)return e.details;s._loadById(t)}return null},s.totalPages=function(){return s.store.getState()[s.name+"s"].total},s}return a}(F),tt="tutorial",et=Object(d.c)({name:"".concat(tt,"s"),initialState:Object(h.a)({},{list:[],dict:{},fetched:[],total:null,loading:!1}),reducers:Object(h.a)(Object(h.a)({},P(tt)),{},{tutorialsReceived:function(t,e){var a=e.payload.results;if(a.length<1)console.log("No tutorials for this contest");else{var n=a[0].contest;t.loading=!1,t.fetched.push(n);for(var s=0;s<a.length;s++)t.dict[a[s].id]=a[s]}}})}),at=et.reducer,nt=function(t){Object(f.a)(a,t);var e=Object(p.a)(a);function a(t,n){var s;return Object(b.a)(this,a),(s=e.call(this,et,t,n,tt))._loadTutorials=function(t){var e=s.store.getState().tutorials;-1!==e.fetched.indexOf(t)||e.loading||s._load("/tutorials/?contest_id=".concat(t))},s.getList=function(t){s._loadTutorials(t);var e=[],a=s.store.getState().tutorials.dict;for(var n in a)a[n].contest===t&&e.push(a[n]);return e},s}return a}(F),st=Object(u.b)({contests:E,problems:Q,submissions:Z,users:K,tutorials:at});var ot=function(){var t=Object(r.useContext)(vt).userActs.currentUser();return Object(n.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:[Object(n.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(n.jsx)("span",{className:"navbar-toggler-icon"})}),Object(n.jsx)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:Object(n.jsxs)("ul",{className:"navbar-nav",children:[Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsxs)(c.c,{className:"nav-link",to:"/",children:["Home ",Object(n.jsx)("span",{className:"sr-only",children:"(current)"})]})}),Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(c.c,{className:"nav-link",to:"/contests",children:"Contests"})}),Object(n.jsx)("li",{className:"nav-item",children:Object(n.jsx)(c.c,{className:"nav-link",to:"/submissions",children:"Submission"})}),Object(n.jsxs)("li",{className:"nav-item",children:[!t&&Object(n.jsx)(c.c,{to:"/users/login",className:"nav-link",children:"Login"}),t&&Object(n.jsx)(c.c,{to:"/users/profile",className:"nav-link",children:"Profile"})]})]})})]})},ct=a(6),rt=a(2),it=(a(54),r.Component,a(24)),lt=a.n(it),dt=function(t){Object(f.a)(a,t);var e=Object(p.a)(a);function a(){var t;Object(b.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(t=e.call.apply(e,[this].concat(s))).state={value:t.props.value},t}return Object(g.a)(a,[{key:"render",value:function(){var t=this,e=this.props,a=e.name,s=e.label,o=e.error,c=e.type,r=e.onChange,i=e.placeholder;return Object(n.jsxs)("div",{className:"form-group",children:[s&&Object(n.jsx)("label",{htmlFor:"{name}",children:Object(n.jsx)("h3",{children:s})}),Object(n.jsx)("input",{type:c,value:this.state.value,onChange:function(e){r(e),t.setState({value:e.currentTarget.value})},id:a,name:a,className:"form-control",autoComplete:"off",placeholder:i}),Object(n.jsx)("p",{children:Object(n.jsx)("small",{})}),o&&Object(n.jsx)("div",{className:"alert alert-danger",children:o})]})}}]),a}(r.Component);dt.defaultProps={type:"text",placeholder:"Input here"};var ut=function(){var t=Object(r.useContext)(vt).userActs.store,e=Object(r.useState)(!!t.getState().problems.loading),a=Object(rt.a)(e,2),s=a[0],o=a[1],c=Object(r.useState)(!!t.getState().users.loading),i=Object(rt.a)(c,2),l=i[0],d=i[1],u=Object(r.useState)(!!t.getState().contests.loading),b=Object(rt.a)(u,2),f=b[0],p=b[1],h=Object(r.useState)(!!t.getState().submissions.loading),g=Object(rt.a)(h,2),j=g[0],m=g[1];t.subscribe((function(){o(!!t.getState().problems.loading),d(!!t.getState().users.loading),p(!!t.getState().contests.loading),m(!!t.getState().submissions.loading)})),Object(r.useEffect)((function(){lt.a.setAppElement("body")}),[]);var v=s||l||f||j;return Object(n.jsx)(lt.a,{isOpen:v,className:"Modal",children:Object(n.jsx)("div",{className:"loader align-middle"})})},bt=a(55),ft=function(t,e){t.update(e)},pt=function(t,e){t.update(e)},ht=function(t,e){t.update(e)},gt=function(t,e){t.update(e)},jt=function(t,e){t.update(e)},mt=function(){var t=Object(r.useContext)(vt),e=t.ws,a=t.contestActs,s=t.problemActs,o=t.submissionActs,c=t.userActs,i=t.tutorialActs;return e.addEventListener("message",(function(t){var e=JSON.parse(t.data).data;"contest"===e.target&&ft(a,e),"problem"===e.target&&pt(s,e),"submission"===e.target&&ht(o,e),"user"===e.target&&gt(c,e),"tutorial"===e.target&&jt(i,e)})),Object(n.jsx)("span",{})},vt=i.a.createContext(),Ot=function(){var t=yt();return Object(r.useEffect)((function(){t.userActs.loadUsers(),A()&&N.get(_+"/login_check/").then((function(t){t.data.status||k()}))}),[]),Object(n.jsx)(vt.Provider,{value:t,children:Object(n.jsxs)("div",{children:[Object(n.jsx)(ut,{}),Object(n.jsx)(ot,{}),Object(n.jsx)(mt,{}),Object(n.jsx)(ct.c,{})]})})},yt=function(){var t=Object(d.a)({reducer:st,middleware:[].concat(Object(l.a)(Object(d.d)()),[R])}),e=A(),a=new bt.a("".concat(function(){var t="https:"===document.location.protocol?"wss://":"ws://";return"localhost"===document.domain?t+"127.0.0.1:8000/ws":t+document.location.host+"/ws"}(),"/?jwt=").concat(e||"hello"),"",{maxReconnectionDelay:6e4,minReconnectionDelay:500});return{contestActs:new J(t,a),userActs:new V(t,a),submissionActs:new $(t,a),problemActs:new W(t,a),tutorialActs:new nt(t,a),store:t,ws:a}};o.a.render(Object(n.jsx)(c.a,{children:Object(n.jsx)(Ot,{})}),document.getElementById("root"))},61:function(t,e,a){}},[[108,1,2]]]);
//# sourceMappingURL=main.b868eae4.chunk.js.map